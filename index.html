<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game of Life Studio</title>
    <link rel="stylesheet" href="/src/css/style.css">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- App Header -->
        <div class="app-header">
            <div class="header-left">
                <button id="mobileMenuBtn" class="mobile-menu-btn">â˜°</button>
                <h1>Game of Life Studio</h1>
            </div>
            <div class="header-controls">
                <button id="darkModeToggle" class="dark-mode-toggle" title="Toggle Dark Mode">
                    <i data-lucide="moon" class="toggle-icon"></i>
                </button>
                <a href="explanation.html" class="help-btn" title="Learn About the Game of Life">?</a>
            </div>
        </div>
        
        <div class="app-body">
            <!-- Mobile Sidebar Overlay -->
            <div class="sidebar-overlay" id="sidebarOverlay"></div>
            
            <!-- Left Sidebar -->
            <div class="sidebar">
            <div class="sidebar-header">
                <h2>ðŸ”§ Controls</h2>
                <button id="sidebarToggle" class="sidebar-toggle">â€¹</button>
            </div>
            
            <div class="sidebar-content">
                <!-- Main Controls Section -->
                <div class="tool-section">
                    <h3>Simulation</h3>

                    <div class="speed-control">
                        <label for="speedSlider">Speed:</label>
                        <div class="slider-group">
                            <input type="range" id="speedSlider" min="1" max="20" value="10">
                            <span id="speedValue">10</span>
                            <input type="number" id="speedMax" class="max-input" value="20" min="10" placeholder="Max">
                        </div>
                    </div>
                    
                    <!-- Visual Controls Toolbar -->
                    <div class="visual-toolbar">
                        <div class="toolbar-group">
                            <button id="pixelGridToggle" class="toolbar-btn" title="Toggle Pixel Grid">
                                <i data-lucide="hash" class="toolbar-icon"></i>
                                <span class="toolbar-label">Pixels</span>
                            </button>
                            
                            <button id="gridToggle" class="toolbar-btn" title="Toggle Grid Overlay">
                                <i data-lucide="grid-3x3" class="toolbar-icon"></i>
                                <span class="toolbar-label">Grid</span>
                            </button>
                            
                            <button id="fadeToggle" class="toolbar-btn" title="Toggle Ghost Trail Mode">
                                <i data-lucide="ghost" class="toolbar-icon"></i>
                                <span class="toolbar-label">Trail</span>
                            </button>
                            
                            <button id="maturityToggle" class="toolbar-btn" title="Toggle Cell Maturity Mode">
                                <i data-lucide="timer" class="toolbar-icon"></i>
                                <span class="toolbar-label">Maturity</span>
                            </button>
                            
                            <button id="cellShapeToggle" class="toolbar-btn" title="Toggle Cell Shape">
                                <i data-lucide="square" class="toolbar-icon"></i>
                                <span class="toolbar-label">Shape</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Settings Panels (Hidden by default) -->
                    <div class="settings-panels">
                        <div class="fade-settings panel-settings" id="fadeSettings" style="display: none;">
                            <h4>Ghost Trail Settings</h4>
                            <div class="setting-row">
                                <label for="fadeSlider">Trail Duration:</label>
                                <div class="slider-group">
                                    <input type="range" id="fadeSlider" min="1" max="10" value="1">
                                    <span id="fadeValue">1</span>
                                    <input type="number" id="fadeMax" class="max-input" value="10" min="5" placeholder="Max">
                                </div>
                            </div>
                        </div>
                        
                        <div class="maturity-settings panel-settings" id="maturitySettings" style="display: none;">
                            <h4>Maturity Settings</h4>
                            <div class="setting-row">
                                <label for="maturityColor">Mature Color:</label>
                                <div class="color-group">
                                    <input type="color" id="maturityColor" value="#4c1d95" class="color-input">
                                    <span class="color-label">Deep Violet</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Drawing Tools Section -->
                <div class="tool-section">
                    <h3>Drawing Tools</h3>
                    <p class="section-desc">Select a tool, then click on the grid</p>
                    <div class="drawing-tools">
                        <!-- Single Cell Drawing -->
                        <button id="cellDrawingBtn" class="tool-btn selected">
                            <i data-lucide="pen-tool" class="tool-icon"></i>
                            <span>Single Cell</span>
                        </button>
                        
                        <!-- Cell Inspector -->
                        <button id="cellInspectorBtn" class="tool-btn">
                            <i data-lucide="search" class="tool-icon"></i>
                            <span>Cell Inspector</span>
                        </button>
                        
                        <!-- Search Box -->
                        <div class="pattern-search">
                            <input type="text" id="patternSearch" placeholder="Search patterns..." class="search-input">
                            <i data-lucide="search" class="search-icon"></i>
                        </div>
                        
                        <!-- Pattern Tree -->
                        <div class="pattern-tree" id="patternTree">
                            <!-- Tree will be dynamically populated by JavaScript -->
                        </div>
                        
                        <!-- Search Results -->
                        <div class="search-results" id="searchResults" style="display: none;">
                            <h4>Search Results</h4>
                            <div class="search-results-list"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Grid Settings Section -->
                <div class="tool-section">
                    <h3>Grid Settings</h3>
                    <div class="slider-control">
                        <label for="gridWidth">Width:</label>
                        <div class="slider-group">
                            <input type="range" id="gridWidth" min="30" max="120" value="60">
                            <span id="gridWidthValue">60</span>
                            <input type="number" id="gridWidthMax" class="max-input" value="120" min="60" placeholder="Max">
                        </div>
                    </div>
                    <div class="slider-control">
                        <label for="gridHeight">Height:</label>
                        <div class="slider-group">
                            <input type="range" id="gridHeight" min="20" max="80" value="40">
                            <span id="gridHeightValue">40</span>
                            <input type="number" id="gridHeightMax" class="max-input" value="80" min="40" placeholder="Max">
                        </div>
                    </div>
                    <div class="slider-control">
                        <label for="cellSize">Cell Size:</label>
                        <div class="slider-group">
                            <input type="range" id="cellSize" min="3" max="20" value="10">
                            <span id="cellSizeValue">10px</span>
                            <input type="number" id="cellSizeMax" class="max-input" value="20" min="10" placeholder="Max">
                        </div>
                    </div>
                </div>
                
                <!-- Random Generation Section -->
                <div class="tool-section">
                    <h3>Random Generation</h3>
                    <div class="slider-control">
                        <label for="randomDensity">Density:</label>
                        <div class="slider-group">
                            <input type="range" id="randomDensity" min="5" max="80" value="30">
                            <span id="randomDensityValue">30%</span>
                            <input type="number" id="randomDensityMax" class="max-input" value="80" min="30" placeholder="Max">
                        </div>
                    </div>
                    <div class="control-row">
                        <label for="randomSeed">Seed:</label>
                        <input type="number" id="randomSeed" value="" placeholder="Random">
                        <button id="generateSeedBtn" class="seed-btn">ðŸŽ²</button>
                    </div>
                </div>
                
                <!-- Custom Rules Section -->
                <div class="tool-section">
                    <div class="section-header" data-toggle="rules">
                        <h3>ðŸ§¬ Custom Rules</h3>
                        <i data-lucide="chevron-down" class="section-toggle"></i>
                    </div>
                    <div class="section-content">
                        <div class="rule-presets">
                            <label>Presets:</label>
                            <select id="rulePresets" class="rule-preset-select">
                                <option value="B3/S23">Conway's Life (B3/S23)</option>
                                <option value="B36/S23">HighLife (B36/S23)</option>
                                <option value="B3/S238">Mazectric (B3/S238)</option>
                                <option value="B368/S245">Move (B368/S245)</option>
                                <option value="B2/S">Seeds (B2/S)</option>
                                <option value="B1/S1">Gnarl (B1/S1)</option>
                                <option value="B1357/S1357">Replicator (B1357/S1357)</option>
                                <option value="custom">Custom...</option>
                            </select>
                        </div>
                        
                        <div class="custom-rule-inputs" id="customRuleInputs">
                            <div class="rule-input-group">
                                <label for="birthRules">Birth (B):</label>
                                <div class="neighbor-checkboxes">
                                    <span class="rule-description">Dead cells become alive with</span>
                                    <div class="checkbox-row">
                                        <label class="checkbox-label"><input type="checkbox" id="birth0" value="0"> 0</label>
                                        <label class="checkbox-label"><input type="checkbox" id="birth1" value="1"> 1</label>
                                        <label class="checkbox-label"><input type="checkbox" id="birth2" value="2"> 2</label>
                                        <label class="checkbox-label"><input type="checkbox" id="birth3" value="3" checked> 3</label>
                                        <label class="checkbox-label"><input type="checkbox" id="birth4" value="4"> 4</label>
                                    </div>
                                    <div class="checkbox-row">
                                        <label class="checkbox-label"><input type="checkbox" id="birth5" value="5"> 5</label>
                                        <label class="checkbox-label"><input type="checkbox" id="birth6" value="6"> 6</label>
                                        <label class="checkbox-label"><input type="checkbox" id="birth7" value="7"> 7</label>
                                        <label class="checkbox-label"><input type="checkbox" id="birth8" value="8"> 8</label>
                                    </div>
                                    <span class="rule-helper">neighbors</span>
                                </div>
                            </div>
                            
                            <div class="rule-input-group">
                                <label for="survivalRules">Survival (S):</label>
                                <div class="neighbor-checkboxes">
                                    <span class="rule-description">Live cells survive with</span>
                                    <div class="checkbox-row">
                                        <label class="checkbox-label"><input type="checkbox" id="survive0" value="0"> 0</label>
                                        <label class="checkbox-label"><input type="checkbox" id="survive1" value="1"> 1</label>
                                        <label class="checkbox-label"><input type="checkbox" id="survive2" value="2" checked> 2</label>
                                        <label class="checkbox-label"><input type="checkbox" id="survive3" value="3" checked> 3</label>
                                        <label class="checkbox-label"><input type="checkbox" id="survive4" value="4"> 4</label>
                                    </div>
                                    <div class="checkbox-row">
                                        <label class="checkbox-label"><input type="checkbox" id="survive5" value="5"> 5</label>
                                        <label class="checkbox-label"><input type="checkbox" id="survive6" value="6"> 6</label>
                                        <label class="checkbox-label"><input type="checkbox" id="survive7" value="7"> 7</label>
                                        <label class="checkbox-label"><input type="checkbox" id="survive8" value="8"> 8</label>
                                    </div>
                                    <span class="rule-helper">neighbors</span>
                                </div>
                            </div>
                            
                            <div class="rule-display">
                                <label>Current Rule:</label>
                                <div class="rule-string" id="currentRuleString">B3/S23</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions Section -->
                <div class="tool-section">
                    <h3>Quick Actions</h3>
                    <div class="quick-actions">
                        <button id="fillRandomBtn">Fill Random</button>
                        <button id="fillEdgesBtn">Fill Edges</button>
                        <button id="fillCenterBtn">Fill Center</button>
                        <button id="invertBtn">Invert All</button>
                    </div>
                </div>
            </div>
            </div>
            
            <!-- Main Content Area -->
            <div class="main-content">
                <div class="game-container">
                    <canvas id="gameCanvas" width="600" height="400"></canvas>
                    <button id="exitFullscreenBtn" class="exit-fullscreen-btn" style="display: none;" title="Exit Fullscreen (ESC)">
                        <i data-lucide="minimize" class="btn-icon"></i>
                    </button>
                    
                    <!-- Floating Controls for Fullscreen -->
                    <div class="fullscreen-floating-controls" id="fullscreenFloatingControls" style="display: none;">
                        <button id="fullscreenPlayPauseBtn" class="floating-control-btn" title="Play/Pause">
                            <i data-lucide="play" class="btn-icon"></i>
                        </button>
                        <button id="fullscreenShuffleBtn" class="floating-control-btn" title="Generate Random Pattern">
                            <i data-lucide="shuffle" class="btn-icon"></i>
                        </button>
                        <button id="fullscreenClearBtn" class="floating-control-btn" title="Clear All Cells">
                            <i data-lucide="trash-2" class="btn-icon"></i>
                        </button>
                    </div>
                </div>
                
                <div class="info">
                                            <div class="info-left">
                            <div class="control-buttons">
                                <button id="startStopBtn" class="control-btn play-pause-btn" title="Start/Stop Simulation">
                                    <i data-lucide="play" class="btn-icon"></i>
                                </button>
                                <button id="resetBtn" class="control-btn" title="Reset to Initial State">
                                    <i data-lucide="refresh-cw" class="btn-icon"></i>
                                </button>
                                <button id="randomBtn" class="control-btn" title="Generate Random Pattern">
                                    <i data-lucide="shuffle" class="btn-icon"></i>
                                </button>
                                <button id="clearBtn" class="control-btn" title="Clear All Cells">
                                    <i data-lucide="trash-2" class="btn-icon"></i>
                                </button>
                                <button id="recordBtn" class="control-btn record-btn" title="Start/Stop Recording">
                                    <i data-lucide="circle" class="btn-icon"></i>
                                </button>
                                <button id="finishBtn" class="control-btn finish-btn" title="Finish & Save Recording" style="display: none;">
                                    <i data-lucide="save" class="btn-icon"></i>
                                </button>
                                <button id="fullscreenBtn" class="control-btn" title="Enter Fullscreen">
                                    <i data-lucide="maximize" class="btn-icon"></i>
                                </button>
                            </div>
                        </div>
                    <div class="info-right">
                        <p>Generation: <span id="generation">0</span></p>
                        <p>Population: <span id="population">0</span></p>
                    </div>
                </div>
                
                <!-- Timeline Section -->
                <div class="timeline-section" id="timelineSection" style="display: none;">
                    <div class="timeline-header">
                        <h3>ðŸŽ¬ Recording Timeline</h3>
                        <div class="timeline-controls">
                            <button id="playTimelineBtn" class="timeline-btn" title="Play Timeline">
                                <i data-lucide="play" class="timeline-icon"></i>
                            </button>
                            <button id="pauseTimelineBtn" class="timeline-btn" title="Pause Timeline" style="display: none;">
                                <i data-lucide="pause" class="timeline-icon"></i>
                            </button>
                            <button id="stopTimelineBtn" class="timeline-btn" title="Stop Timeline">
                                <i data-lucide="stop" class="timeline-icon"></i>
                            </button>
                            <span class="timeline-info">
                                <span id="currentFrame">0</span> / <span id="totalFrames">0</span>
                            </span>
                        </div>
                    </div>
                    
                    <div class="timeline-bar">
                        <input type="range" id="timelineSlider" min="0" max="0" value="0" class="timeline-slider">
                    </div>
                    
                    <div class="timeline-settings">
                        <label for="playbackSpeed">Playback Speed:</label>
                        <input type="range" id="playbackSpeed" min="1" max="10" value="5" class="speed-slider">
                        <span id="speedValue">5x</span>
                    </div>
                </div>
                
                <!-- Recording Management -->
                <div class="tool-section" id="recordingsSection">
                    <div class="section-header" data-toggle="recordings">
                        <h3>ðŸ’¾ Saved Recordings</h3>
                        <i data-lucide="chevron-down" class="toggle-icon"></i>
                    </div>
                    <div class="section-content" id="recordingsContent">
                        <div class="recordings-controls">
                            <button id="loadRecordingsBtn" class="load-btn" title="Load Recordings">
                                <i data-lucide="folder-open" class="btn-icon"></i>
                                Load
                            </button>
                        </div>
                        <div class="recordings-list" id="recordingsList">
                            <p class="no-recordings">No recordings available. Start recording to save your simulations!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Save Recording Modal -->
    <div class="modal-overlay" id="saveModal" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h3>ðŸ’¾ Save Recording</h3>
                <button class="modal-close" id="modalClose">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <label for="recordingName">Recording Name:</label>
                <input type="text" id="recordingName" placeholder="Enter recording name..." maxlength="50">
                <div class="recording-stats">
                    <p>Generations recorded: <span id="recordedGenerations">0</span></p>
                    <p>Duration: <span id="recordingDuration">0s</span></p>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelSave" class="cancel-btn">Cancel</button>
                <button id="confirmSave" class="save-btn">Save Recording</button>
            </div>
        </div>
    </div>
    
    <script type="module" src="/src/js/game-engine.js"></script>
    <script type="module" src="/src/js/patterns.js"></script>
    <script type="module" src="/src/js/gameoflifestudio.js"></script>
</body>
</html>
