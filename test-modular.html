<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modular Game of Life Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        canvas {
            border: 1px solid #000;
            margin: 10px 0;
        }
        
        button {
            margin: 5px;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            background: #007bff;
            color: white;
            cursor: pointer;
        }
        
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>üß™ Modular Game of Life Architecture Test</h1>
    
    <div id="moduleTests" class="test-section">
        <h2>Module Loading Tests</h2>
        <div id="moduleResults"></div>
    </div>
    
    <div id="gameTests" class="test-section">
        <h2>Game Functionality Tests</h2>
        <canvas id="gameCanvas" width="400" height="300"></canvas>
        <div>
            <button onclick="testBasicGame()">Test Basic Game</button>
            <button onclick="testDrawing()">Test Cell Drawing</button>
            <button onclick="testPatterns()">Test Patterns</button>
            <button onclick="testFullscreen()">Test Fullscreen</button>
        </div>
        <div id="gameResults"></div>
    </div>
    
    <div id="comparisonTests" class="test-section">
        <h2>Architecture Comparison</h2>
        <div id="comparisonResults">
            <div class="test-result warning">
                <strong>Before Refactoring:</strong> Single monolithic file with 2,956 lines
            </div>
            <div class="test-result success">
                <strong>After Refactoring:</strong> 11+ modular files with clear separation of concerns
            </div>
        </div>
    </div>

    <script type="module">
        import { GameEngine } from './src/js/core/GameEngine.js';
        import { CanvasRenderer } from './src/js/renderer/CanvasRenderer.js';
        import { MaturitySystem } from './src/js/features/MaturitySystem.js';
        import { FadeSystem } from './src/js/features/FadeSystem.js';
        import { CellInspector } from './src/js/features/CellInspector.js';
        import { FullscreenManager } from './src/js/features/FullscreenManager.js';
        import { GameOfLifePatterns } from './src/js/patterns/PatternLibrary.js';
        import { eventBus } from './src/js/utils/EventEmitter.js';
        import { ColorUtils } from './src/js/utils/ColorUtils.js';
        import { DEFAULTS, EVENTS, DRAWING_MODES } from './src/js/utils/Constants.js';
        
        const moduleResults = document.getElementById('moduleResults');
        const gameResults = document.getElementById('gameResults');
        
        // Test module loading
        function testModules() {
            const modules = [
                { name: 'GameEngine', module: GameEngine },
                { name: 'CanvasRenderer', module: CanvasRenderer },
                { name: 'MaturitySystem', module: MaturitySystem },
                { name: 'FadeSystem', module: FadeSystem },
                { name: 'CellInspector', module: CellInspector },
                { name: 'FullscreenManager', module: FullscreenManager },
                { name: 'GameOfLifePatterns', module: GameOfLifePatterns },
                { name: 'EventBus', module: eventBus },
                { name: 'ColorUtils', module: ColorUtils },
                { name: 'Constants', module: DEFAULTS }
            ];
            
            modules.forEach(({ name, module }) => {
                const result = document.createElement('div');
                result.className = module ? 'test-result success' : 'test-result error';
                result.innerHTML = `‚úÖ <strong>${name}</strong>: ${module ? 'Loaded successfully' : 'Failed to load'}`;
                moduleResults.appendChild(result);
            });
        }
        
        // Initialize test game instance
        let testGame = null;
        
        window.testBasicGame = function() {
            try {
                const canvas = document.getElementById('gameCanvas');
                const engine = new GameEngine(30, 40);
                const renderer = new CanvasRenderer(canvas, 10);
                
                // Test basic operations
                engine.setCell(10, 20, true);
                engine.setCell(11, 20, true);
                engine.setCell(12, 20, true);
                
                renderer.drawGrid(engine.grid, {});
                
                const population = engine.calculatePopulation();
                
                const result = document.createElement('div');
                result.className = 'test-result success';
                result.innerHTML = `‚úÖ <strong>Basic Game Test</strong>: Engine created, cells set, population: ${population}`;
                gameResults.appendChild(result);
                
            } catch (error) {
                const result = document.createElement('div');
                result.className = 'test-result error';
                result.innerHTML = `‚ùå <strong>Basic Game Test Failed</strong>: ${error.message}`;
                gameResults.appendChild(result);
            }
        };
        
        window.testDrawing = function() {
            try {
                const canvas = document.getElementById('gameCanvas');
                const engine = new GameEngine(30, 40);
                const renderer = new CanvasRenderer(canvas, 10);
                
                // Test drawing functionality
                engine.toggleCell(5, 5);
                engine.toggleCell(5, 6);
                engine.toggleCell(6, 5);
                
                const population = engine.calculatePopulation();
                renderer.drawGrid(engine.grid, {});
                
                const result = document.createElement('div');
                result.className = 'test-result success';
                result.innerHTML = `‚úÖ <strong>Drawing Test</strong>: Cells toggled successfully, population: ${population}`;
                gameResults.appendChild(result);
                
            } catch (error) {
                const result = document.createElement('div');
                result.className = 'test-result error';
                result.innerHTML = `‚ùå <strong>Drawing Test Failed</strong>: ${error.message}`;
                gameResults.appendChild(result);
            }
        };
        
        window.testPatterns = function() {
            try {
                const canvas = document.getElementById('gameCanvas');
                const engine = new GameEngine(30, 40);
                const renderer = new CanvasRenderer(canvas, 10);
                
                // Test pattern placement
                const glider = GameOfLifePatterns.getPattern('glider');
                if (glider) {
                    engine.placePattern(glider.pattern, 10, 10, 0);
                    const population = engine.calculatePopulation();
                    renderer.drawGrid(engine.grid, {});
                    
                    const result = document.createElement('div');
                    result.className = 'test-result success';
                    result.innerHTML = `‚úÖ <strong>Pattern Test</strong>: Glider placed successfully, population: ${population}`;
                    gameResults.appendChild(result);
                } else {
                    throw new Error('Glider pattern not found');
                }
                
            } catch (error) {
                const result = document.createElement('div');
                result.className = 'test-result error';
                result.innerHTML = `‚ùå <strong>Pattern Test Failed</strong>: ${error.message}`;
                gameResults.appendChild(result);
            }
        };
        
        window.testFullscreen = function() {
            try {
                const canvas = document.getElementById('gameCanvas');
                const fullscreenManager = new FullscreenManager(canvas);
                
                const result = document.createElement('div');
                result.className = 'test-result success';
                result.innerHTML = `‚úÖ <strong>Fullscreen Test</strong>: FullscreenManager created successfully`;
                gameResults.appendChild(result);
                
            } catch (error) {
                const result = document.createElement('div');
                result.className = 'test-result error';
                result.innerHTML = `‚ùå <strong>Fullscreen Test Failed</strong>: ${error.message}`;
                gameResults.appendChild(result);
            }
        };
        
        // Run module tests on load
        testModules();
        
        // Add architecture benefits
        setTimeout(() => {
            const benefits = document.createElement('div');
            benefits.innerHTML = `
                <h3>üéØ Modular Architecture Benefits</h3>
                <div class="test-result success"><strong>‚úÖ Maintainability:</strong> Each module has a single responsibility</div>
                <div class="test-result success"><strong>‚úÖ Testability:</strong> Individual modules can be tested in isolation</div>
                <div class="test-result success"><strong>‚úÖ Reusability:</strong> Modules can be reused in other projects</div>
                <div class="test-result success"><strong>‚úÖ Readability:</strong> Code is organized logically by feature</div>
                <div class="test-result success"><strong>‚úÖ Scalability:</strong> New features can be added without touching existing modules</div>
                <div class="test-result success"><strong>‚úÖ Debugging:</strong> Issues can be isolated to specific modules</div>
            `;
            document.getElementById('comparisonResults').appendChild(benefits);
        }, 1000);
        
    </script>
</body>
</html>
